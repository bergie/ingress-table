topic: "ingress-table/CalculateState"
name: "Portal state calculation"
fixture:
 type: 'fbp'
 data: |
  # @runtime noflo

  INPORT=c.STATE:IN
  INPORT=g.KEY:KEY
  OUTPORT=g.OUT:OUT

  c(ingress-table/CalculateState) STATE -> IN g(objects/GetObjectKey)

cases:
-
  name: 'receiving a stable portal'
  assertion: 'should set state as stable'
  inputs:
    key: 'state'
    in:
      title: 'c-base space station'
      guid: 'a6301120831b46f1be00fa2cb0bce195.16'
      health: 100
      level: 4
      team: 'RESISTANCE'
  expect:
    equals:
      out: 'stable'